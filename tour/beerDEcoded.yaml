id: beerDEcoded
name: BeerDEcoded - StreetScienceCommunity
description: Workflow finds yeast strains contained in a sequenced beer sample.
title_default: <b>BeerDEcoded</b>
steps:
  - title: <b>[INFO]</b> DNA in beer
    content: >-
      Beer contains DNA that comes from its ingredients and some hundred microbes. There are 1,000+ yeasts used for brewing and 200+ hop varieties, each one bearing a different DNA and contributing to differentiate its properties.<br>
      Thanks to sequencing it is now easier to find the different genomes contained in a beer sample and investigate their characteristics. The sequencing of the full genome of 157 brewing yeast strains was, for example, recently reported (<a href="https://pubmed.ncbi.nlm.nih.gov/27610566/">Gallone B, Steensels J, Prahl T, et al. 2016</a>).<br>
    backdrop: true      
  - title: <b>[INFO]</b> The effect of microbiom on beer
    content: >-      
      Based on the identification of strains present in beer with desired characteristics, controlled experiments in which the microbial composition of the brew is altered could allow us to investigate if the presence of specific microorganisms affects flavour. The origin of each yeast species can be investigated; i.e. whether they come with the ingredients or from the environment at the production site. Furthermore, plant DNA, such as malt and hop varieties, can be found in beer samples, and the bacterial diversity can be mapped.
    backdrop: true
  - title: <b>[INFO]</b> How to study the microbiome of beer
    content: >-
      To study the microbiome of beer you need to find out what is inside the beer. Getting this inside can be found by extracting the DNAs of the living organisms (yeast) inside the beer. Now you would also like to 'read' this DNA. This can be achieved by sequencing the DNA.<br>Having these sequences now enables us to do a Data analysis, which we will do in the following.
    backdrop: true 
  - title: <b>[INFO]</b> Workflow of BeerDEcoded process
    content: >-
      The beerDeCoded process contains 3 consistent steps. The first step is DNA extraction from beer. Then, this DNA can be sequenced. That means that we can obtain the sequence of nucleotides for this specific DNA. Finally, we have to analyze received data in order to know which organisms this DNA is from.<br><img src="images/workflow-of-beerDeCoded.png" alt="workflow of beerDeCoded process" width="400" height="400">
  - title: <b>[ACTION]</b> Create a new history
    element: '#history-new-button'
    intro: >-
      Let's start by creating a new history.<br>Click on the button <b>'Create
      new history'</b><br>
    position: left
    preclick:
      - '#center-panel'
  - title: <b>[ACTION]</b> Rename the history
    element: '#current-history-panel > div.controls'
    intro: Change the name of the new history to <b>'BeerDEcoded'</b>.
    position: left
  - title: <b>[INFO]</b> Description of FASTQ format
    content: We need to upload data. We will start with a <b>fastq</b> file.<br>FASTQ format is a text-based format for storing both a biological sequence and its corresponding quality scores. Both the sequence letter and the quality score are encoded with a single ASCII character for brevity.<br>A FASTQ file normally uses four lines per sequence.<br><ul type="circle"> <li>Line 1 begins with a '@' character and is followed by a sequence identifier and an optional description.</li><li>Line 2 is the raw sequence letters.</li><li>Line 3 begins with a '+' character and is optionally followed by the same sequence identifier (and any description) again.</li><li>Line 4 encodes the quality values for the sequence in Line 2, and must contain the same number of symbols as letters in the sequence.</li> </ul><br>You can find more info in the <a href="https://en.wikipedia.org/wiki/FASTQ_format">Wikipedia article.</a>
    backdrop: true
  - title: <b>[ACTION]</b> Open Galaxy Upload Manager
    element: .upload-button
    intro: >-
      We will import fastq into the history we just created.<br><br> Click
      <b>'Next'</b> and the tour will open Galaxy Upload Manager and take you to
      the Upload screen.
    position: right
    postclick:
      - .upload-button
  - title: <b>[ACTION]</b> Uploading the input data
    intro: Upload the data by clicking the <b>'Paste/Fetch Data'</b> button.
  - title: <b>[ACTION]</b> Choose the variant of uploading the input data
    content: >-
      Load the data into your history by providing the links or choose your
      fastq file from your computer. <br>Click on <b>'Start'</b> to upload the
      data into your Galaxy history.
  - title: <b>[ACTION]</b> Close the window once the files are uploaded
    content: >-
      The upload may take awhile.<br><br> Hit the <b>Close</b> button when you
      see that the files are uploaded into your history.
  - title: <b>[INFO]</b> Uploading the input data Complete !
    content: 'Now that your data is ready, let''s analyze it!<br>'
    backdrop: true
  - title: <b>[INFO]</b> Key step in metagenomic data analysis
    content: >-
      One of the key steps in metagenomic data analysis is to identify the taxon to which the individual read belongs. Taxonomic classification tools are using microbial genome databases to identify the origin of each sequence.<br>
    backdrop: true
  - title: <b>[INFO]</b> Process of taxonomic classification with Kraken2
    content: >-
      To perform the taxonomic classification we will use Kraken2. This tool uses <a href="https://en.wikipedia.org/wiki/K-mer">k-mers</a> (the read’s subsequences of length k) to assign a taxonomic label to the sequence (if possible).<br>The taxonomic label is assigned based on matches of k-mer content of the considering sequence to the k-mer content of reference genome sequence. The result is a classification of the considering sequence to the most likely taxonomic label. If the k-mer content is not similar to any genomic sequence in the database used, it will not assign any taxonomic label.<br>
      <img src="images/kraken2_simlified.jpg" alt="Kraken2 simlified process image" width="400" height="400">
    backdrop: true
  - title: <b>[ACTION]</b> Go to the tool menu
    element: .toolMenuContainer
    intro: Available tools appear here in the <b>tool menu</b>.
    position: right
  - title: <b>[ACTION]</b> Search for 'Kraken2' tool
    element: '#__BVID__106'
    content: >-
      You can use <b>'tool search'</b> to locate tools.<br><br> Search for 
      <b>'Kraken2'</b> and select it.<br><br> Tools may take a couple of moments
      to load.
    placement: right
  - title: <b>[ACTION]</b> Open 'Kraken2' tool
    element: .toolMenuContainer
    intro: >-
      Open <b>'Kraken2'</b> tool<br><br> Click <b>'Next'</b> to continue our
      tour.
    position: right
  - title: <b>[INFO]</b> Description of Kraken2 parameters
    element: 'div[tour_id="use_names"]'
    intro: >-
      Have a look at the tool's parameters of the <b>'Kraken2'</b> tool.<br><br>
      <small>Additional info:<br><b>Parameter ‘Single or paired reads’</b><br>Single-end reads are the fragments sequenced from one side. With paired-end sequencing, the fragments are sequenced from both sides. This approach results in two reads per fragment, with the first read in forward orientation and the second read in reverse-complement orientation. With this technique, we have the advantage to get more information about each DNA fragment compared to reads sequenced by only single-end sequencing<br><b>Parameter ‘Confidence'</b><br>A confidence score of 0.0 means that non-restrictive taxonomic assignation is desired. This value can be increased if a more restrictive taxonomic assignation is desired. For example, a confidence score of 0.1 means that at least 10% of the k-mers should match entries in the database. <br><b>Parameter ‘Select a Kraken2 database’</b><br>We need to identify the taxon to which the individual reads belong. To identify the origin of each sequence, taxonomic classification tools use  microbial genome databases. For this tutorial, we will use the <i>fungi2019-03</i> database.</small><br>
    placement: right
  - title: <b>[ACTION]</b> Choose parameters and execute Kraken2
    intro: >-
      Please select the following parameters:<br><br> <b>'Single or paired
      reads'</b>: Single <br> <b>'Input sequences'</b>: Uploaded dataset<br>
      <b>'Print scientific names instead of just taxids'</b>: Yes<br>
      <b>'Confidence'</b>: 0.0<br> <b>'In “Create Report”'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<b>'Print a report with aggregrate counts/clade to
      file'</b>: Yes<br> &nbsp;&nbsp;&nbsp;&nbsp;<b>'Format report output like
      Kraken 1’s kraken-mpa-report'</b>: Yes<br> <b>'Select a Kraken2
      database'</b>: fungi2019-03' <br><br>Click <b>'Next'</b> and the tour will
      <b>'Execute'</b> the Kraken2 tool for you.'<br>
    postclick:
      - '#execute'
  - title: <b>[ACTION]</b> View the output of Kraken2
    element: '#current-history-panel > div.controls'
    intro: >-
      Congratulations, you have created two files. It contains Classification
      and Report file.<br><br> It will remain stored in your history.<br><br>
      Click the <b>'eye'</b> icon to view the data once the history item turns
      green.<br><br>
    position: left
  - title: <b>[INFO]</b> Description of the Kraken2 output</b>
    element: '#current-history-panel > div.controls'
    intro: >-
      <small>Additional info (<a href="https://github.com/DerrickWood/kraken2/wiki/Manual#output-formats">from Kraken Manual</a>):<br>
      In <b>classification file</b> each sequence (or sequence pair, in the case of paired reads) classified by Kraken 2 results in a single line of output. Kraken 2's output lines contain five tab-delimited fields; from left to right, they are:
      <ol><li>"C"/"U": a one letter code indicating that the sequence was either classified or unclassified.</li><li>The sequence ID, obtained from the FASTA/FASTQ header.</li><li>The taxonomy ID Kraken 2 used to label the sequence; this is 0 if the sequence is unclassified.</li><li>The length of the sequence in bp. In the case of paired read data, this will be a string containing the lengths of the two sequences in bp, separated by a pipe character, e.g. "98|94".</li><li>A space-delimited list indicating the LCA mapping of each k-mer in the sequence(s). For example, "562:13 561:4 A:31 0:1 562:3" would indicate that:<br><ul><li>the first 13 k-mers mapped to taxonomy ID #562</li><li>the next 4 k-mers mapped to taxonomy ID #561</li><li>the next 31 k-mers contained an ambiguous nucleotide</li><li>the next k-mer was not in the database</li><li>the last 3 k-mers mapped to taxonomy ID #562</li></ul>Note that paired read data will contain a "|:|" token in this list to indicate the end of one read and the beginning of another.When Kraken 2 is run against a protein database (see [Translated Search]), the LCA hitlist will contain the results of querying all six frames of each sequence. Reading frame data is separated by a "-:-" token.</li></ol>
      Kraken 2's standard sample <b>report file</b> format is tab-delimited with one line per taxon. The fields of the output, from left-to-right, are as follows:<ol><li>Percentage of fragments covered by the clade rooted at this taxon</li><li>Number of fragments covered by the clade rooted at this taxon</li><li>Number of fragments assigned directly to this taxon</li><li>A rank code, indicating (U)nclassified, (R)oot, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, or (S)pecies. Taxa that are not at any of these 10 ranks have a rank code that is formed by using the rank code of the closest ancestor rank with a number indicating the distance from that rank. E.g., "G2" is a rank code indicating a taxon is between genus and species and the grandparent taxon is at the genus rank.</li><li>NCBI taxonomic ID number</li><li>Indented scientific name</li></ol>The scientific names are indented using space, according to the tree structure specified by the taxonomy.</small>
    position: left
  - title: <b>[INFO]</b> The next step for visualization
    content: >-
      Once we have assigned the corresponding taxa to the sequence, the next
      step is to properly visualize the data, for which we will use the Krona
      pie chart tool (<a href="https://doi.org/10.1186/1471-2105-12-385">Ondov
      et al. 2011</a>).<br>
    backdrop: true
  - title: <b>[INFO]</b> Adjust dataset format
    content: >-
       It can happen, that the output format of the tool needs to be changed in order for the next tool to read the data.Galaxy offers several "manipulation" tools.<br><br>The format of the file created after executing Kraken2 has a tabular format with one column and one line per taxon. Every line contains the information divided by | symbol. In order to make it more readable and usable by next tools we need a tab-delimited format with one line per taxon. The fields of the output, from left-to-right, should be as follows:1) Number of fragments assigned directly to this taxon; 2) A rank code, indicating (U)nclassified, (R)oot, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, or (S)pecies.<br><br>Here we need to adjust the format of the data output from Kraken2.<br>
    backdrop: true
  - title: <b>[ACTION]</b> Select 'Reverse' tool
    element: '#__BVID__106'
    intro: >-
      Search and select the <b>'Reverse'</b> tool.
    position: right
  - title: <b>[ACTION]</b> Choose parameters and execute 'Reverse' tool
    intro: >-
      You have selected the Reverse tool.<br> Ensure that for <b>'Input tabular
      dataset'</b> you have selected the report output file from
      Kraken2.<br><br> <b>'Execute'</b> the Reverse tool when you are ready.
    position: right
  - title: <b>[ACTION]</b> Select 'Replace Text' tool
    element: '#__BVID__106'
    intro: Search and select the <b>'Replace Text'</b> tool.
    position: right
  - title: <b>[ACTION]</b> Choose parameters and execute 'Replace Text' tool
    intro: >-
      You have selected the Replace Text tool.<br><br> Please select the
      following parameters:<br><br> <b>'File to process'</b>: Output dataset
      'out_file' from 'Reverse' tool<br> <b>'In “Replacements”'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<b>'Replacement 1'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Find pattern'</b>:
      \|<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Replace
      with:'</b>: \t<br> &nbsp;&nbsp;&nbsp;&nbsp;<b>'Replacement 2'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Find pattern'</b>:
      [a-z]__<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Replace
      with:'</b>: Empty <br><br>  <b>'Execute'</b> the Reverse tool when you are
      ready.
    position: right
  - title: <b>[INFO]</b> Visualization of the taxonomical classification with Krona
    content: >-
      <b>Krona</b> allows hierarchical data to be explored with zooming,
      multi-layered pie charts. With this tool, we can easily visualize the
      composition of the bacterial communities and compare how the populations
      of microorganisms are modified according to the conditions of the
      environment.
    backdrop: true
  - title: <b>[ACTION]</b> Select 'Krona pie chart' tool
    element: '#__BVID__106'
    intro: Search and select the <b>'Krona pie chart'</b> tool.
    position: right
  - title: <b>[ACTION]</b> Choose parameters and execute 'Krona pie chart' tool
    intro: >-
      You have selected the 'Krona pie chart' tool.<br><br> Please select the
      following parameters:<br><br> <b>'What is the type of your input
      data'</b>: Tabular<br> <b>'Input file'</b>: Output dataset 'out_file' from
      'Replace Text' tool<br> <b>'Provide a name for the basal rank'</b>:
      Root<br> <b>'Combine data from multiple datasets?'</b>: No<br> <br><br>
      <b>'Execute'</b> the 'Krona pie chart' tool when you are ready.
    position: right
  - title: <b>[ACTION]</b> View the 'Krona pie chart' output
    element: '#current-history-panel > div.controls'
    intro: >-
      Let’s take a look at the result by clicking eye icon. Using the search bar
      we can check if certain taxa are present.
    position: left
    preclick:
      - '#center-panel'
  - title: <b>[INFO]</b> The end of the tour BeerDEcoded
    intro: >-
      You have reached the end of the tour.<br><br>Thank you for going through
      our tutorial.
    backdrop: true
